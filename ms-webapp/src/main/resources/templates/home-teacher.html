<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <meta name="app-success" th:content="${success}" th:if="${success}"/>
    <meta name="app-error" th:content="${error}" th:if="${error}"/>
    <title>Accueil | KundApp</title>
    <link th:href="@{/css/mdb.min.css}" rel="stylesheet"/>
    <link th:href="@{/css/index.css}" rel="stylesheet"/>
</head>
<body>
<nav class="navbar navbar-expand-lg">
    <div class="container">
        <div class="logo me-3">
            <img th:src="@{/images/kundapplogo.jpg}" alt="KundApp Logo" />
        </div>
        <a class="navbar-brand" href="/teacher">KundApp</a>
        <button class="navbar-toggler" type="button" data-mdb-toggle="collapse" data-mdb-target="#navbarMain">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarMain">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a class="nav-link active" href="/teacher">Accueil</a>
                </li>
            </ul>
            <div class="d-flex align-items-center">
                <span class="me-3" th:if="${user != null}" th:text="${user.email}">teacher@kundapp.com</span>
                <form th:action="@{/logout}" method="post" class="d-inline">
                    <button type="submit" class="btn btn-outline-primary">D√©connexion</button>
                </form>
            </div>
        </div>
    </div>
</nav>

<!-- Success/Error Messages -->
<div class="toast-container" id="toastContainer"></div>

<div class="container py-4">
    <div class="welcome-banner">
        <div class="row align-items-center">
            <div class="col-md-8">
                <h1 class="h4 mb-0">Bienvenue sur votre espace KundApp</h1>
                <p class="mb-0">Consultez et g√©rez vos prochaines s√©ances</p>
            </div>
            <div class="col-md-4 text-end">
                <button class="btn btn-primary" onclick="openCreateSessionModal()">
                    Cr√©er une s√©ance
                </button>
            </div>
        </div>
    </div>

    <!-- Tabs Navigation -->
    <ul class="nav nav-tabs mb-4" id="teacherSessionTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="upcoming-sessions-tab" data-mdb-toggle="tab" data-mdb-target="#upcoming-sessions" type="button" role="tab">
                Mes prochaines s√©ances
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="history-sessions-tab" data-mdb-toggle="tab" data-mdb-target="#history-sessions" type="button" role="tab">
                Historique
            </button>
        </li>
    </ul>

    <!-- Tab Content -->
    <div class="tab-content" id="teacherSessionTabsContent">
        <!-- Upcoming Sessions Tab -->
        <div class="tab-pane fade show active" id="upcoming-sessions" role="tabpanel">
            <div class="row mb-4">
                <div class="col">
                    <div class="card">
                        <div class="card-body p-0">
                            <h5 class="card-title p-3 mb-0 border-bottom">Mes prochaines s√©ances</h5>
                            <!-- Sessions Cards Container -->
                            <div class="p-3">
                                <div class="row">
                                    <!-- Session Card -->
                                    <div th:each="sessionItem : ${sessions}"
                                         class="col-12 mb-3"
                                         data-session-card
                                         th:data-subject="${sessionItem.subject}"
                                         th:data-online="${sessionItem.isOnline}">
                                        <div class="session-card-content">
                                            <div class="row g-0 align-items-center">
                                                <!-- Colonne 1 - Gauche : Date/Heure/Sujet -->
                                                <div class="col-4 session-col-left">
                                                    <div class="session-title-line">
                                                        <h5 class="session-title mb-0 fw-bold" th:text="${sessionItem.subject}">YOGA</h5>
                                                    </div>
                                                    <div class="session-date-line">
                                                        <small th:text="${#temporals.format(sessionItem.startDateTime, 'EEEE d MMMM yyyy')}">lundi 15 janvier 2025</small>
                                                    </div>
                                                    <div class="session-time-line">
                                                        <small>
                                                            <span th:text="${#temporals.format(sessionItem.startDateTime, 'HH:mm')}">14:00</span>
                                                            -
                                                            <span th:text="${#temporals.format(sessionItem.startDateTime.plusMinutes(sessionItem.durationMinutes), 'HH:mm')}">15:00</span>
                                                        </small>
                                                    </div>
                                                </div>

                                                <!-- Colonne 2 - Milieu : Lieu et Participants -->
                                                <div class="col-4 session-col-center">
                                                    <div class="session-teacher-line">
                                                        <!-- Ligne vide pour garder l'alignement -->
                                                        <span>&nbsp;</span>
                                                    </div>
                                                    <div class="session-room-line">
                                                        <small>
                                                            <th:block th:if="${sessionItem.isOnline}">
                                                                <span class="session-online-badge">üíª En ligne</span>
                                                            </th:block>
                                                            <th:block th:unless="${sessionItem.isOnline}">
                                                                <span th:text="${sessionItem.roomName ?: 'Lieu non d√©fini'}">Studio Yoga</span>
                                                            </th:block>
                                                        </small>
                                                    </div>
                                                    <div class="session-participants-line">
                                                        <small>
                                                            <button th:if="${(sessionItem.registeredParticipants ?: 0) > 0}"
                                                                    class="btn btn-link btn-sm p-0 text-decoration-none"
                                                                    th:onclick="|showParticipants(${sessionItem.id})|"
                                                                    style="font-size: inherit; color: inherit;">
                                                                <span th:text="${sessionItem.registeredParticipants ?: 0}">5</span> participants
                                                                (<span th:text="${sessionItem.availableSpots - (sessionItem.registeredParticipants ?: 0)}">3</span> places)
                                                            </button>
                                                            <span th:if="${(sessionItem.registeredParticipants ?: 0) == 0}">
                                                                0 participants
                                                                (<span th:text="${sessionItem.availableSpots}">8</span> places)
                                                            </span>
                                                        </small>
                                                    </div>
                                                </div>

                                                <!-- Colonne 3 - Droite : Actions -->
                                                <div class="col-4 session-col-right">
                                                    <div class="session-register-line">
                                                        <!-- Bouton Modifier -->
                                                        <button type="button" class="btn btn-outline-primary btn-sm"
                                                                th:onclick="|openEditSessionModal(${sessionItem.id})|"
                                                                style="min-width: 120px;">
                                                            Modifier
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Message si aucune session -->
                                <div class="text-center py-5" th:if="${sessions == null || sessions.isEmpty()}">
                                    <div class="text-muted">
                                        <h5>Aucune s√©ance programm√©e</h5>
                                        <p class="mb-3">Vous n'avez pas encore cr√©√© de s√©ances.</p>
                                        <button class="btn btn-primary" onclick="openCreateSessionModal()">
                                            Cr√©er une s√©ance
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- History Sessions Tab -->
        <div class="tab-pane fade" id="history-sessions" role="tabpanel">
            <div class="row mb-4">
                <div class="col">
                    <div class="card">
                        <div class="card-body p-0">
                            <h5 class="card-title p-3 mb-0 border-bottom">Historique de mes s√©ances</h5>
                            <!-- History Sessions Cards Container -->
                            <div class="p-3">
                                <div class="row">
                                    <!-- History Session Card -->
                                    <div th:each="historySession : ${historySessions}"
                                         class="col-12 mb-3"
                                         data-session-card
                                         th:data-subject="${historySession.subject}"
                                         th:data-online="${historySession.isOnline}"
                                         th:data-status="${historySession.status}">
                                        <div class="session-card-content"
                                             th:classappend="${historySession.status?.name() == 'CANCELLED'} ? 'session-cancelled' : ''">
                                            <!-- Badge Status -->
                                            <span class="badge badge-status-right"
                                                  th:classappend="${historySession.status?.name() == 'CANCELLED'} ? 'bg-warning' : 'bg-success'">
                                                <span th:text="${historySession.status?.name() == 'CANCELLED'} ? 'Annul√©e' : 'Termin√©e'">Termin√©e</span>
                                            </span>

                                            <div class="row g-0 align-items-center">
                                                <!-- Colonne 1 - Gauche : Date/Heure/Sujet -->
                                                <div class="col-4 session-col-left">
                                                    <div class="session-title-line">
                                                        <h5 class="session-title mb-0 fw-bold" th:text="${historySession.subject}">YOGA</h5>
                                                    </div>
                                                    <div class="session-date-line">
                                                        <small th:text="${#temporals.format(historySession.startDateTime, 'EEEE d MMMM yyyy')}">lundi 15 janvier 2025</small>
                                                    </div>
                                                    <div class="session-time-line">
                                                        <small>
                                                            <span th:text="${#temporals.format(historySession.startDateTime, 'HH:mm')}">14:00</span>
                                                            -
                                                            <span th:text="${#temporals.format(historySession.startDateTime.plusMinutes(historySession.durationMinutes), 'HH:mm')}">15:00</span>
                                                        </small>
                                                    </div>
                                                </div>

                                                <!-- Colonne 2 - Milieu : Lieu et Participants -->
                                                <div class="col-4 session-col-center">
                                                    <div class="session-teacher-line">
                                                        <!-- Ligne vide pour garder l'alignement -->
                                                        <span>&nbsp;</span>
                                                    </div>
                                                    <div class="session-room-line">
                                                        <small>
                                                            <th:block th:if="${historySession.isOnline}">
                                                                <span class="session-online-badge">üíª En ligne</span>
                                                            </th:block>
                                                            <th:block th:unless="${historySession.isOnline}">
                                                                <span th:text="${historySession.roomName ?: 'Lieu non d√©fini'}">Studio Yoga</span>
                                                            </th:block>
                                                        </small>
                                                    </div>
                                                    <div class="session-participants-line">
                                                        <small>
                                                            <th:block th:if="${historySession.status?.name() == 'COMPLETED'}">
                                                                <button th:if="${(historySession.registeredParticipants ?: 0) > 0}"
                                                                        class="btn btn-link btn-sm p-0 text-decoration-none"
                                                                        th:onclick="|showParticipants(${historySession.id})|"
                                                                        style="font-size: inherit; color: inherit;">
                                                                    <span th:text="${historySession.registeredParticipants ?: 0}">5</span> participants
                                                                </button>
                                                                <span th:if="${(historySession.registeredParticipants ?: 0) == 0}">
                                                                    Aucun participant
                                                                </span>
                                                            </th:block>
                                                            <th:block th:if="${historySession.status?.name() == 'CANCELLED'}">
                                                                Session annul√©e
                                                            </th:block>
                                                        </small>
                                                    </div>
                                                </div>

                                                <!-- Colonne 3 - Droite : Actions -->
                                                <div class="col-4 session-col-right">
                                                    <div class="session-register-line">
                                                        <!-- Pas d'actions pour l'historique -->
                                                        <span class="text-muted small">
                                                            Session <span th:text="${historySession.status?.name() == 'CANCELLED'} ? 'annul√©e' : 'termin√©e'">termin√©e</span>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Message si aucune session d'historique -->
                                <div class="text-center py-5" th:if="${historySessions == null || historySessions.isEmpty()}">
                                    <div class="text-muted">
                                        <h5>Aucun historique</h5>
                                        <p class="mb-3">Vous n'avez pas encore d'historique de s√©ances termin√©es ou annul√©es.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Session Creation Modal -->
<div class="modal fade" id="sessionModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="sessionModalTitle">Cr√©er une s√©ance</h5>
                <button type="button" class="btn-close" data-mdb-dismiss="modal"></button>
            </div>
            <form id="sessionForm" action="/teacher/sessions/create" method="post">
                <div class="modal-body">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

                    <!-- Sujet -->
                    <div class="mb-3">
                        <label for="sessionSubject" class="form-label">Type de cours *</label>
                        <select class="form-select" id="sessionSubject" name="subject" required>
                            <option value="">Choisissez un type de cours...</option>
                            <option value="YOGA">Yoga</option>
                            <option value="KUNDALINI">Kundalini</option>
                            <option value="PILATES">Pilates</option>
                            <option value="SOIN_ENERGETIQUE">Soin √©nerg√©tique</option>
                            <option value="MEDITATION">M√©ditation</option>
                        </select>
                    </div>

                    <!-- Description -->
                    <div class="mb-3">
                        <label for="sessionDescription" class="form-label">Description *</label>
                        <textarea class="form-control" id="sessionDescription" name="description"
                                  rows="3" placeholder="Description de la s√©ance" required></textarea>
                    </div>
                    <!-- Type de session -->
                    <hr>
                    <h6 class="mb-3">Type de session</h6>
                    <div class="mb-3">
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="sessionType" id="sessionTypeIrl" value="false" checked>
                            <label class="form-check-label" for="sessionTypeIrl">
                                <i class="fas fa-map-marker-alt me-1"></i>En pr√©sentiel
                            </label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="sessionType" id="sessionTypeOnline" value="true">
                            <label class="form-check-label" for="sessionTypeOnline">
                                En ligne
                            </label>
                        </div>
                        <input type="hidden" id="sessionIsOnline" name="isOnline" value="false">
                    </div>

                    <!-- Informations de lieu -->
                    <hr>
                    <h6 class="mb-3" id="sessionLocationTitle">Lieu de la s√©ance</h6>

                    <!-- Champs pour session IRL -->
                    <div id="sessionIrlFields">
                        <div class="row">
                            <div class="col-md-8 mb-3">
                                <label for="sessionRoomName" class="form-label">Nom de la salle/lieu *</label>
                                <input type="text" class="form-control" id="sessionRoomName" name="roomName"
                                       placeholder="Ex: Studio Yoga Paris, Salle A, Parc des Buttes Chaumont...">
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="sessionPostalCode" class="form-label">Code postal *</label>
                                <input type="text" class="form-control" id="sessionPostalCode" name="postalCode"
                                       pattern="^(0[1-9]|[1-8][0-9]|9[0-8])\d{3}$"
                                       placeholder="75001" maxlength="5">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="sessionGoogleMapsLink" class="form-label">Lien Google Maps</label>
                            <input type="url" class="form-control" id="sessionGoogleMapsLink" name="googleMapsLink"
                                   placeholder="https://maps.app.goo.gl/...">
                            <div class="form-text">Optionnel - Ajoutez un lien Google Maps pour faciliter l'acc√®s</div>
                        </div>
                    </div>

                    <!-- Champs pour session en ligne -->
                    <div id="sessionOnlineFields" style="display: none;">
                        <div class="mb-3">
                            <label for="sessionZoomLink" class="form-label">Lien Zoom *</label>
                            <input type="url" class="form-control" id="sessionZoomLink" name="zoomLink"
                                   placeholder="https://zoom.us/j/123456789">
                            <div class="form-text">Lien de la r√©union Zoom pour la session en ligne</div>
                        </div>
                    </div>

                    <!-- Date et heure - UNIFIED with datetime-local -->
                    <hr>
                    <h6 class="mb-3">Date et horaires</h6>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="sessionStartDateTime" class="form-label">Date et heure de d√©but *</label>
                            <input type="datetime-local" class="form-control" id="sessionStartDateTime" name="startDateTime" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="sessionDurationMinutes" class="form-label">Dur√©e (minutes) *</label>
                            <select class="form-select" id="sessionDurationMinutes" name="durationMinutes" required>
                                <option value="">Choisir...</option>
                                <option value="15">15 min</option>
                                <option value="30">30 min</option>
                                <option value="45">45 min</option>
                                <option value="60" selected>1h00</option>
                                <option value="75">1h15</option>
                                <option value="90">1h30</option>
                                <option value="105">1h45</option>
                                <option value="120">2h00</option>
                                <option value="150">2h30</option>
                                <option value="180">3h00</option>
                            </select>
                        </div>
                    </div>

                    <!-- Participants et cr√©dits -->
                    <hr>
                    <h6 class="mb-3">Participants et cr√©dits</h6>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="sessionAvailableSpots" class="form-label">Nombre de places *</label>
                            <input type="number" class="form-control" id="sessionAvailableSpots"
                                   name="availableSpots" min="1" max="50" value="10" required>
                            <div class="form-text">Entre 1 et 50 participants</div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="sessionCreditsRequired" class="form-label">Cr√©dits requis *</label>
                            <input type="number" class="form-control" id="sessionCreditsRequired"
                                   name="creditsRequired" min="1" max="10" value="1" required>
                            <div class="form-text">Nombre de cr√©dits n√©cessaires pour participer</div>
                        </div>
                    </div>

                    <!-- Mat√©riel -->
                    <div id="sessionMaterialSection">
                        <hr>
                        <h6 class="mb-3">Mat√©riel</h6>
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="sessionBringYourMattress"
                                       name="bringYourMattress" value="true">
                                <label class="form-check-label" for="sessionBringYourMattress">
                                    <strong>Les participants doivent apporter leur tapis</strong>
                                </label>
                                <div class="form-text">Cochez si les participants doivent venir avec leur propre √©quipement</div>
                            </div>
                            <input type="hidden" name="bringYourMattress" value="false">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Annuler</button>
                    <button type="submit" class="btn btn-primary">Cr√©er la s√©ance</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- Session Update Modal -->
<div class="modal fade" id="sessionUpdateModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Modifier la s√©ance</h5>
                <button type="button" class="btn-close" data-mdb-dismiss="modal"></button>
            </div>
            <form id="sessionUpdateForm" method="post">
                <div class="modal-body">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                    <input type="hidden" id="sessionUpdateId" name="id">

                    <!-- Subject -->
                    <div class="mb-3">
                        <label for="sessionUpdateSubject" class="form-label">Type de cours *</label>
                        <select class="form-select" id="sessionUpdateSubject" name="subject" required>
                            <option value="">Choisissez un type de cours...</option>
                            <option value="YOGA">Yoga</option>
                            <option value="KUNDALINI">Kundalini</option>
                            <option value="PILATES">Pilates</option>
                            <option value="SOIN_ENERGETIQUE">Soin √©nerg√©tique</option>
                            <option value="MEDITATION">M√©ditation</option>
                        </select>
                    </div>

                    <!-- Description -->
                    <div class="mb-3">
                        <label for="sessionUpdateDescription" class="form-label">Description *</label>
                        <textarea class="form-control" id="sessionUpdateDescription" name="description"
                                  rows="3" placeholder="D√©crivez cette s√©ance en d√©tail..." required></textarea>
                    </div>
                    <!-- Session type  -->
                    <hr>
                    <h6 class="mb-3">Type de session</h6>
                    <div class="mb-3">
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="sessionUpdateType" id="sessionUpdateTypeIrl" value="false">
                            <label class="form-check-label" for="sessionUpdateTypeIrl">
                                <i class="fas fa-map-marker-alt me-1"></i>En pr√©sentiel
                            </label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="sessionUpdateType" id="sessionUpdateTypeOnline" value="true">
                            <label class="form-check-label" for="sessionUpdateTypeOnline">
                                En ligne
                            </label>
                        </div>
                        <input type="hidden" id="sessionUpdateIsOnline" name="isOnline" value="false">
                        <div class="form-text">
                            <i class="fas fa-info-circle me-1"></i>
                            Vous pouvez changer le type de session. Les champs sp√©cifiques √† l'ancien type seront effac√©s.
                        </div>
                    </div>

                    <!-- Location information -->
                    <hr>
                    <h6 class="mb-3" id="sessionUpdateLocationTitle">Lieu de la s√©ance</h6>

                    <!-- IRL fields-->
                    <div id="sessionUpdateIrlFields">
                        <div class="row">
                            <div class="col-md-8 mb-3">
                                <label for="sessionUpdateRoomName" class="form-label">Nom de la salle/lieu *</label>
                                <input type="text" class="form-control" id="sessionUpdateRoomName" name="roomName"
                                       placeholder="Ex: Studio Yoga Paris, Salle A, Parc des Buttes Chaumont...">
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="sessionUpdatePostalCode" class="form-label">Code postal *</label>
                                <input type="text" class="form-control" id="sessionUpdatePostalCode" name="postalCode"
                                       pattern="^(0[1-9]|[1-8][0-9]|9[0-8])\d{3}$"
                                       placeholder="75001" maxlength="5">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="sessionUpdateGoogleMapsLink" class="form-label">Lien Google Maps</label>
                            <input type="url" class="form-control" id="sessionUpdateGoogleMapsLink" name="googleMapsLink"
                                   placeholder="https://maps.app.goo.gl/...">
                            <div class="form-text">Optionnel - Ajoutez un lien Google Maps pour faciliter l'acc√®s</div>
                        </div>
                    </div>

                    <!-- Online fields -->
                    <div id="sessionUpdateOnlineFields" style="display: none;">
                        <div class="mb-3">
                            <label for="sessionUpdateZoomLink" class="form-label">Lien Zoom *</label>
                            <input type="url" class="form-control" id="sessionUpdateZoomLink" name="zoomLink"
                                   placeholder="https://zoom.us/j/123456789">
                            <div class="form-text">Lien de la r√©union Zoom pour la session en ligne</div>
                        </div>
                    </div>

                    <!-- Date and time -->
                    <hr>
                    <h6 class="mb-3">Date et horaires</h6>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="sessionUpdateStartDateTime" class="form-label">Date et heure de d√©but *</label>
                            <input type="datetime-local" class="form-control" id="sessionUpdateStartDateTime" name="startDateTime" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="sessionUpdateDurationMinutes" class="form-label">Dur√©e *</label>
                            <select class="form-select" id="sessionUpdateDurationMinutes" name="durationMinutes" required>
                                <option value="">Choisir...</option>
                                <option value="15">15 min</option>
                                <option value="30">30 min</option>
                                <option value="45">45 min</option>
                                <option value="60">1h00</option>
                                <option value="75">1h15</option>
                                <option value="90">1h30</option>
                                <option value="105">1h45</option>
                                <option value="120">2h00</option>
                                <option value="150">2h30</option>
                                <option value="180">3h00</option>
                            </select>
                        </div>
                    </div>

                    <!-- Participants & credits -->
                    <hr>
                    <h6 class="mb-3">Participants et cr√©dits</h6>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="sessionUpdateAvailableSpots" class="form-label">Nombre de places *</label>
                            <input type="number" class="form-control" id="sessionUpdateAvailableSpots"
                                   name="availableSpots" min="1" max="50" required>
                            <div class="form-text">Entre 1 et 50 participants</div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="sessionUpdateCreditsRequired" class="form-label">Cr√©dits requis *</label>
                            <input type="number" class="form-control" id="sessionUpdateCreditsRequired"
                                   name="creditsRequired" min="1" max="10" required>
                            <div class="form-text">Nombre de cr√©dits n√©cessaires pour participer</div>
                        </div>
                    </div>


                    <!-- Material (related to IRL sessions) -->
                    <div id="sessionUpdateMaterialSection">
                        <hr>
                        <h6 class="mb-3">Mat√©riel</h6>
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="sessionUpdateBringYourMattress"
                                       name="bringYourMattress" value="true">
                                <label class="form-check-label" for="sessionUpdateBringYourMattress">
                                    <strong>Les participants doivent apporter leur tapis</strong>
                                </label>
                                <div class="form-text">Cochez si les participants doivent venir avec leur propre √©quipement</div>
                            </div>
                            <input type="hidden" name="bringYourMattress" value="false">
                        </div>
                    </div>

                    <!-- Participants section -->
                    <hr>
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h6 class="mb-0">üìã Participants inscrits</h6>
                        <button type="button" class="btn btn-sm p-1"
                                id="toggleParticipantsBtn" onclick="toggleParticipantsSection()"
                                style="border: none; background: none;">
                            <span id="toggleParticipantsIcon" style="font-size: 14px;">‚ñ∂</span>
                        </button>
                    </div>

                    <div id="participantsCountLine" class="alert alert-info mb-3">
                        <span id="sessionUpdateParticipantsCount">0 participant(s) inscrit(s)</span>
                    </div>

                    <!-- Participants section (hidden) -->
                    <div id="participantsSection" style="display: none;">
                        <div id="participantsLoading" class="text-center py-3" style="display: none;">
                            <div class="spinner-border spinner-border-sm text-primary" role="status"></div>
                            <span class="ms-2">Chargement...</span>
                        </div>

                        <div id="participantsContent">
                            <div class="table-responsive">
                                <table class="table table-sm table-hover">
                                    <thead>
                                    <tr>
                                        <th>Pr√©nom</th>
                                        <th>Nom</th>
                                        <th>Email</th>
                                    </tr>
                                    </thead>
                                    <tbody id="participantsTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div id="participantsEmpty" class="text-center py-3" style="display: none;">
                            <small class="text-muted">Aucun participant inscrit</small>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="me-auto">
                        <button type="button" class="btn btn-outline-secondary btn-sm session-cancel-btn" id="sessionUpdateCancelBtn">
                            Annuler cette s√©ance
                        </button>
                    </div>
                    <div>
                        <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Fermer</button>
                        <button type="submit" class="btn btn-admin-primary">
                            Mettre √† jour</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- Confirmation Modal -->
<div class="modal fade" id="confirmationModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="confirmationTitle">Confirmation</h5>
                <button type="button" class="btn-close" data-mdb-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p id="confirmationMessage"></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Annuler</button>
                <button type="button" class="btn btn-danger" id="confirmButton">Confirmer</button>
            </div>
        </div>
    </div>
</div>
<!-- Participants Modal-->
<div class="modal fade" id="participantsModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Participants √† la s√©ance</h5>
                <button type="button" class="btn-close" data-mdb-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div id="participantsModalLoading" class="text-center py-3" style="display: none;">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Chargement...</span>
                    </div>
                    <p class="mt-2">Chargement des participants...</p>
                </div>
                <div id="participantsModalContent">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                            <tr>
                                <th>Pr√©nom</th>
                                <th>Nom</th>
                                <th>Email</th>
                            </tr>
                            </thead>
                            <tbody id="participantsModalTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
                <div id="participantsModalEmpty" class="text-center py-4" style="display: none;">
                    <h6>Aucun participant inscrit</h6>
                    <p class="text-muted">Cette s√©ance n'a pas encore de participants inscrits.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Fermer</button>
            </div>
        </div>
    </div>
</div>

<footer class="py-3 mt-5 bg-white border-top">
    <div class="container">
        <p class="text-center text-muted mb-0">¬© 2025 KundApp. Tous droits r√©serv√©s.</p>
    </div>
</footer>

<!-- Scripts dans le bon ordre -->
<script th:src="@{/js/common.js}"></script>
<script th:src="@{/js/teacher.js}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.4.0/mdb.min.js"></script>
</body>
</html>